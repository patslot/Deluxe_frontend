<!DOCTYPE html>
<html>

<head>
  <%- include('partials/extHeader.ejs') %>
  <title>Apple Daily Deluxe</title>
  <%- include('partials/googleAdTag.ejs', {adTag: 'Index'}) %>
  <link rel="stylesheet" href="/css/common.css" />
</head>

<body ng-app="addv2" ng-controller="HomepageController">
  <%- include('partials/app.ejs') %>
  <skinner-block></skinner-block>

  <div class="nm_v_menu visible-xs" vmenu="content">
    <div ng-include="'/partials/mobileMenu.html'"></div>
  </div>
  <div class="container nm_home">
    <top-menu ng-categories="categs"></top-menu>
    <div class="row nm_row">
      <!--<div class="skinner_ad" skinner_ad_left></div>-->
      <div class="main_content">
        <div class="nm_section">
          <div class="head_banner_wrapper">
            <div class="superhead_banner">
              <div id="headBanner">
                <script>
                  showWebAd("HeadBanner", "headBanner");
                </script>
              </div>
            </div>
          </div>
          <div class="row nm_row">
            <div class="pull-right lrec_ad_wrapper hidden-xs">
              <div class="lrec_ad_large">
                <div id="lrec1">
                  <script>
                    showWebAd("LREC1", "lrec1");
                  </script>
                </div>
              </div>
              <div class="lrec_ad_large">
                <div id="lrec2">
                  <script>
                    showWebAd("LREC2", "lrec2");
                  </script>
                </div>
              </div>
            </div>
            <div class="pull-right nm_mpm col-xs-12">
              <div class="mpm_content">
                <%- include('partials/mpms.ejs', {mpms: mpms}) %>
              </div>
            </div>
          </div>
        </div>

        <div ng-include="'/partials/homeArticlesFacebook.html'"></div>
        <div ng-include="'/partials/homeArticles.html'"></div>
        <add-carousel title-class="'nm_highlight'" carousel-items="highlights"
          carousel-div="'highlight-carousel'"></add-carousel>
        <div class="nm_section" lazy-scroll="lazyLoadHomepage()" lazy-no-scroll="loaded">
          <div align="center" ng-show="loading" style="margin-top: 20px">
            <img src="/img/loading.gif" />
          </div>
        </div>
        <div ng-if="loaded">
          <div class="nm_section" loading="content">
            <div class="head_banner_wrapper">
              <div class="superhead_banner">
                <div id="midbanner1">
                  <script>
                    showWebAd("Midbanner", "midbanner1");
                  </script>
                </div>
              </div>
            </div>
          </div>
          <div ng-include="'/partials/homeArticlesInstagram.html'"></div>
          <div ng-include="'/partials/homeArticlesEvent.html'"></div>
          <add-carousel title-class="'nm_editor_pick'" carousel-items="editorPicks"
            carousel-div="'editor-picks-carousel'"></add-carousel>
          <div class="nm_section">
            <!-- TODO(Nancy): load midbanner2, midbanner3, ... -->
            <!-- div class="head_banner_wrapper">
              <div class="superhead_banner">
                <div id="midbanner2">
                  <script>
                    showWebAd("Midbanner", "midbanner2");
                  </script>
                </div>
              </div>
            </div -->
            <div class="row" ng-repeat="articles in categArticles">
              <div class="col-sm-4 nm_section_block" ng-repeat="a in articles">
                <home-article add-article="a"></home-article>
              </div>
            </div>
          </div>
        </div>
        <!--<div class="skinner_ad" skinner_ad_right></div>-->
      </div>

      <div ng-include="'/partials/footer.html'"></div>
      <div ng-include="'/partials/newsletter.html'"></div>
    </div>

    <script>
      // $(document).ready(function(){
      // 	var $skinnerAdRight = $('[skinner_ad_right]');
      // 	var $skinnerAdLeft = $('[skinner_ad_left]');
      // 	var $skinnerAdRightContainer = $skinnerAdRight.parent();
      // 	var updateSkinnerAd = function(){

      // 		if ($(document).scrollTop() >= 170){
      // 			$('.skinner_ad').addClass('fixed');
      // 			var offset = $(document).width() - $('body').width();
      // 			// console.log(offset);
      // 			$skinnerAdRight.css('right', ($(document).width() - ($skinnerAdRightContainer.position().left + $skinnerAdRightContainer.width())) - (offset > 0 ? offset - $(document).scrollLeft() : 0 ));
      // 			if (offset > 0){
      // 				$skinnerAdLeft.css('left', - $(document).scrollLeft());
      // 			}
      // 			else{
      // 				$skinnerAdLeft.attr('style', 'left:auto');
      // 			}
      // 		}
      // 		else{
      // 			$('.skinner_ad').removeClass('fixed');
      // 			$skinnerAdRight.css('right', '0px');
      // 			$skinnerAdLeft.css('left', '0px');
      // 		}
      // 	}
      // 	updateSkinnerAd();
      // 	$(document).on('scroll', updateSkinnerAd);
      // });
    </script>
</body>

</html>
